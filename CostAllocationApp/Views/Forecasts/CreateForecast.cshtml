
@{
    ViewBag.Title = "Create Forecast";
}
@section Styles {
    <link href="@Url.Content("~/Content/forecast.css")" rel="stylesheet" type="text/css" />
}

<div class="content container-fluid" style="position:relative">
    <!-- Page Header -->
    <div class="page-header">
        <div class="row align-items-center">
            <div class="col">
                <h5>Forecast Creation</h5>
            </div>
        </div>
    </div>
    <!-- /Page Header -->
    <div class="row">
        <div class="col-md-12">
            <section class="container" tabIndex="1">
                <div>
                    <table id="forecast_search">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Section</th>
                                <th>Department</th>
                                <th>In-Charge</th>
                                <th>Role</th>
                                <th>Explanation</th>
                                <th>Company</th>
                                <th>Period</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    <input type="text" value="" id="identity_search" class="create_forecast name_search" />
                                </td>

                                <td class="create_forecast section_search">
                                    <div class="forecast_multiselect">
                                        <div class="forecast_checkbox section" onclick="SectionCheck()">
                                            <select id="section_search">
                                                <option>All</option>
                                            </select>
                                            <div></div>
                                        </div>

                                        <div id="sectionChks" class="commonselect">
                                        </div>
                                    </div>
                                </td>

                                <td class="create_forecast department_search">
                                    <div class="forecast_multiselect">
                                        <div class="forecast_checkbox department" onclick="DepartmentCheck()">
                                            <select id="department_search">
                                                <option>All</option>
                                            </select>
                                            <div></div>
                                        </div>
                                        <div id="departmentChks" class="commonselect">

                                        </div>
                                    </div>
                                </td>

                                <td class="create_forecast incharge_search">
                                    <div class="forecast_multiselect">
                                        <div class="forecast_checkbox incharge" onclick="InchargeCheck()">
                                            <select id="incharge_search">
                                                <option>All</option>
                                            </select>
                                            <div></div>
                                        </div>
                                        <div id="inchargeChks" class="commonselect">

                                        </div>
                                    </div>
                                </td>

                                <td class="create_forecast role_search">
                                    <div class="forecast_multiselect">
                                        <div class="forecast_checkbox role" onclick="RoleCheck()">
                                            <select id="role_search">
                                                <option>All</option>
                                            </select>
                                            <div></div>
                                        </div>
                                        <div id="RoleChks" class="commonselect">

                                        </div>
                                    </div>
                                </td>

                                <td class="create_forecast explanation_search">
                                    <div class="forecast_multiselect">
                                        <div class="forecast_checkbox explanation" onclick="ExplanationCheck()">
                                            <select id="explanation_search">
                                                <option>All</option>
                                            </select>
                                            <div></div>
                                        </div>
                                        <div id="ExplanationChks" class="commonselect">

                                        </div>
                                    </div>
                                </td>

                                <td class="create_forecast company_search">
                                    <div class="forecast_multiselect">
                                        <div class="forecast_checkbox company" onclick="CompanyCheck()">
                                            <select id="company_search">
                                                <option>All</option>
                                            </select>
                                            <div></div>
                                        </div>
                                        <div id="CompanyChks" class="commonselect">
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    <select id="period_search" class="create_forecast period_search">
                                        <option value="">Select Period</option>
                                        <option value="2023">2023</option>

                                    </select>
                                </td>
                            </tr>

                            @*<tr>
                                    <td>
                                        <input type="text" class="form-control" id="identity_search" placeholder="name">
                                    </td>
                                    <td>
                                        <select id="section_search" class="form-control"></select>
                                    </td>
                                    <td>
                                        <select id="department_search" class="form-control"></select>
                                    </td>
                                    <td>
                                        <select id="incharge_search" class="form-control"></select>
                                    </td>
                                    <td>
                                        <select id="role_search" class="form-control"></select>
                                    </td>
                                    <td>
                                        <select id="explanation_search" class="form-control"></select>
                                    </td>
                                    <td>
                                        <select id="company_search" class="form-control"></select>
                                    </td>
                                    <td>
                                        <select id="period_search" class="form-control col-12">
                                            <option value="">Select Period</option>
                                            <option value="2023">2023</option>

                                        </select>
                                    </td>
                                </tr>*@
                            <tr>
                                <td colspan="7"></td>
                                <td>
                                    <a href="javascript:void(0);" class="" id="forecast_search_button">Search</a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <div class="row">
                <div class="col-md-12">
                    <div class="forecast">
                        <div id="loading" style="display:none;position:absolute;left:0;top:0;  width:100%;height:100%;">
                            <center>
                                <img src="~/img/forecast_loader.gif" height="250" width="250" style="margin-top:200px;">
                                <br>
                                <strong>Please wait a moment...</strong>
                                <br>
                                <br>
                            </center>
                        </div>
                        <table class="" id="forecast_table">
                            <thead></thead>
                            <tbody></tbody>
                        </table>
                        <div class="add_name_tbl_2_btn">
                            <a href="javascript:void(0);" class="" id="cancel_forecast" onclick="onCancel()" style="display:none;">Cancel</a>
                            <a href="javascript:void(0);" class="" id="save_forecast" onclick="onSave()" style="display:none;">Save</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<input type="hidden" id="hidSectionId" />
<input type="hidden" id="hidDepartmentId" />
<input type="hidden" id="hidInChargeId" />
<input type="hidden" id="hidRoleId" />
<input type="hidden" id="hidExplanationId" />
<input type="hidden" id="hidCompanyid" />

@section Scripts{
    <script src="/Scripts/forecast.js"></script>
    <script type="text/javascript">

        var globalSearchObject = '';

        function checkPoint(element) {

            var pointValue = $(element).val();
            if (isNaN(pointValue) || pointValue == undefined || pointValue == '') {
                $(element).val('0.0');
            }
            else {
                if (pointValue > 1 || pointValue < 0) {
                    $(element).val('0.0');
                }
            }


            var totalMonthPoint = 0;
            var sameNameTr = [];
            var tr = element.closest('tr');
            //var trId = $(tr).data('rowid');
            var trName = $(tr).find('td').eq(0).children('span').data('name');
            console.log('name:' + trName);
            var allTr = $('#forecast_table > tbody > tr');
            //var monthNumber = $(element).data('month');
            var columnIndex = $(element).parent().index();

            console.log('index: ' + columnIndex);




            $.each(allTr, function (index, value) {
                var tempTrName = $(value).find('td').eq(0).children('span').data('name');
                if (tempTrName == trName) {
                    var monthPoint = $(value).find('td').eq(columnIndex).children('input').val();
                    if (monthPoint == '' || monthPoint == NaN) {
                        totalMonthPoint += 0;
                    }
                    else {
                        totalMonthPoint += parseFloat(monthPoint);
                    }
                    //console.log(td);
                    sameNameTr.push(value);
                }
            });
            if (totalMonthPoint > 1) {
                alert('total month point can not be grater than 1');
                $(element).val('0.0');
            }


            //console.log($(tr).find('td').eq(1).data('name'));

        }

        //function onClickEmpty(element) {
        //    $(element).val('');
        //}

        function onCancel() {
            if (globalSearchObject == '') {
                return;
            }
            else {
                $.ajax({
                    //url: `/api/utilities/SearchForecastEmployee`,
                    //type: 'GET',
                    //dataType: 'json',
                    //data: data_info,
                    url: `/api/utilities/SearchForecastEmployee`,
                    contentType: 'application/json',
                    type: 'GET',
                    dataType: 'json',
                    data: globalSearchObject,
                    success: function (data) {
                        $('#forecast_table>thead').empty();
                        $('#forecast_table>tbody').empty();

                        $('#forecast_table>thead').append(`

                                                <tr>
                                                    <th id="forecast_name">Name </th>
                                                    <th id="forecast_section">Section </th>
                                                    <th id="forecast_department">Department </th>
                                                    <th id="forecast_incharge">In-Charge </th>
                                                    <th id="forecast_role">Role </th>
                                                    <th id="forecast_explanation">Explanation </th>
                                                    <th id="forecast_company">Company Name </i></th>
                                                    <th id="forecast_grade">Grade </th>
                                                    <th id="forecast_unitprice"><span>Unit Price</span> </th>
                                                    <th>10月</th>
                                                    <th>11月</th>
                                                    <th>12月</th>
                                                    <th>1月</th>
                                                    <th>2月</th>
                                                    <th>3月</th>
                                                    <th>4月</th>
                                                    <th>5月</th>
                                                    <th>6月</th>
                                                    <th>7月</th>
                                                    <th>8月</th>
                                                    <th>9月</th>
                                                    <th>Oct</th>
                                                    <th>Nov</th>
                                                    <th>Dec</th>
                                                    <th>Jan</th>
                                                    <th>Feb</th>
                                                    <th>Mar</th>
                                                    <th>Apr</th>
                                                    <th>May</th>
                                                    <th>Jun</th>
                                                    <th>Jul</th>
                                                    <th>Aug</th>
                                                    <th>Sep</th>
                                                </tr>
                                            `);
                        //Forecast_DatatableLoad(data);
                        var _id = 0;
                        var _companyName = '';
                        var _oct = 0;
                        var _octTotal = 0;

                        console.log(data);
                        $('#forecast_table').DataTable({
                            destroy: true,
                            data: data,
                            searching: false,
                            bLengthChange: false,
                            autoWidth: false,
                            pageLength: 100,
                            columns: [
                                //{
                                //    data: 'Id',
                                //    render: function (id) {
                                //        _id = id;
                                //        return null;
                                //    },
                                //    //ordering: false

                                //},
                                {
                                    data: 'EmployeeNameWithCodeRemarks',
                                    render: function (employeeNameWithCodeRemarks) {
                                        var splittedString = employeeNameWithCodeRemarks.split('$');
                                        _id = parseInt(splittedString[3]); // id
                                        if (splittedString[2] == 'true') {
                                            return `<span title='initial' data-name='${splittedString[0]}' style='color:red;'> ${splittedString[1]}</span> <input type='hidden' id='row_id_${_id}' value='${_id}'/>`;
                                        } else {
                                            return `<span title='initial' data-name='${splittedString[0]}'> ${splittedString[1]}</span> <input type='hidden' id='row_id_${_id}' value='${_id}'/>`;
                                        }

                                    }
                                },
                                {
                                    data: 'SectionName',
                                    render: function (sectionName) {
                                        return `<td title='initial'>${sectionName}</td>`;
                                    }
                                },
                                {
                                    data: 'DepartmentName',
                                    render: function (departmentName) {
                                        return `<td title='initial'>${departmentName}</td>`;
                                    }
                                },
                                {
                                    data: 'InchargeName',
                                    render: function (inchargeName) {
                                        return `<td title='initial'>${inchargeName}</td>`;
                                    }
                                },
                                {
                                    data: 'RoleName',
                                    render: function (roleName) {
                                        return `<td title='initial'>${roleName}</td>`;
                                    }
                                },
                                {
                                    data: 'ExplanationName',
                                    render: function (explanationName) {
                                        return `<span title='initial' class='forecast_explanation'>${explanationName}</span>`;
                                    }
                                },
                                {
                                    data: 'CompanyName',
                                    render: function (companyName) {
                                        _companyName = companyName;
                                        return `<td title='initial'>${companyName}</td>`;
                                    }
                                },
                                {
                                    data: 'GradePoint',
                                    render: function (gradePoint) {

                                        if (_companyName.toLowerCase() == 'mw') {
                                            return `<td title='initial'>${gradePoint}</td>`;
                                        }
                                        else {
                                            return `<td title='initial'></td>`;
                                        }

                                    }
                                },
                                {
                                    data: 'UnitPrice',
                                    render: function (unitPrice) {
                                        return `<span id='up_${_id}' data-unitprice=${unitPrice}> ${unitPrice}</span>`;
                                    }
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='oct_${_id}'   onclick="checkPoint_click(this)" onChange="checkPoint(this)"  data-month='10' value='${_forecast[0].Points.toFixed(1)}' class='input_month'/></td>`;
                                        } else {
                                            return `<td><input type='text' id='oct_${_id}'   onclick="checkPoint_click(this)" onChange="checkPoint(this)"  data-month='10' value='0.0' class='input_month'/></td>`;
                                        }

                                    },
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='nov_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='11' value='${_forecast[1].Points.toFixed(1)}' class='input_month'/></td>`;
                                        } else {
                                            return `<td><input type='text' id='nov_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='11' value='0.0' class='input_month'/></td>`;
                                        }

                                    },
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='dec_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='12' value='${_forecast[2].Points.toFixed(1)}' class='input_month'/></td>`;
                                        } else {
                                            return `<td><input type='text' id='dec_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='12' value='0.0' class='input_month'/></td>`;
                                        }

                                    },
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='jan_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='1' value='${_forecast[3].Points.toFixed(1)}' class='input_month'/></td>`;
                                        } else {
                                            return `<td><input type='text' id='jan_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='1' value='0.0' class='input_month'/></td>`;
                                        }

                                    },
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='feb_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='2' value='${_forecast[4].Points.toFixed(1)}' class='input_month'/></td>`;
                                        } else {
                                            return `<td><input type='text' id='feb_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='2' value='0.0' class='input_month'/></td>`;
                                        }

                                    },
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='mar_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='3' value='${_forecast[5].Points.toFixed(1)}' class='input_month'/></td>`;
                                        } else {
                                            return `<td><input type='text' id='mar_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='3' value='0.0' class='input_month'/></td>`;
                                        }

                                    },
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='apr_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='4' value='${_forecast[6].Points.toFixed(1)}' class='input_month'/></td>`;
                                        } else {
                                            return `<td><input type='text' id='apr_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='4' value='0.0' class='input_month'/></td>`;
                                        }

                                    },
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='may_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='5' value='${_forecast[7].Points.toFixed(1)}' class='input_month'/></td>`;
                                        } else {
                                            return `<td><input type='text' id='may_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='5' value='0.0' class='input_month'/></td>`;
                                        }

                                    },
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='jun_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='6' value='${_forecast[8].Points.toFixed(1)}' class='input_month'/></td>`;
                                        } else {
                                            return `<td><input type='text' id='jun_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='6' value='0.0' class='input_month'/></td>`;
                                        }

                                    },
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='jul_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='7' value='${_forecast[9].Points.toFixed(1)}' class='input_month'/></td>`;
                                        } else {
                                            return `<td><input type='text' id='jul_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='7' value='0.0' class='input_month'/></td>`;
                                        }

                                    },
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='aug_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='8' value='${_forecast[10].Points.toFixed(1)}' class='input_month'/></td>`;
                                        } else {
                                            return `<td><input type='text' id='aug_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='8' value='0.0' class='input_month'/></td>`;
                                        }

                                    },
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='sep_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='9' value='${_forecast[11].Points.toFixed(1)}' class='input_month'/></td>`;
                                        } else {
                                            return `<td><input type='text' id='sep_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='9' value='0.0' class='input_month'/></td>`;
                                        }

                                    },
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='oct_output_${_id}' value='${_forecast[0].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        } else {
                                            return `<td><input type='text' id='oct_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        }

                                    },
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='nov_output_${_id}' value='${_forecast[1].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        } else {
                                            return `<td><input type='text' id='nov_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        }

                                    },
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='dec_output_${_id}' value='${_forecast[2].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        } else {
                                            return `<td><input type='text' id='dec_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        }

                                    },
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='jan_output_${_id}' value='${_forecast[3].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        } else {
                                            return `<td><input type='text' id='jan_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        }

                                    },
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='feb_output_${_id}' value='${_forecast[4].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        } else {
                                            return `<td><input type='text' id='feb_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        }

                                    },
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='mar_output_${_id}' value='${_forecast[5].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        } else {
                                            return `<td><input type='text' id='mar_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        }

                                    },
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='apr_output_${_id}' value='${_forecast[6].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        } else {
                                            return `<td><input type='text' id='apr_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        }

                                    },
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='may_output_${_id}' value='${_forecast[7].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        } else {
                                            return `<td><input type='text' id='may_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        }

                                    },
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='jun_output_${_id}' value='${_forecast[8].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        } else {
                                            return `<td><input type='text' id='jun_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        }

                                    },
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='jul_output_${_id}' value='${_forecast[9].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        } else {
                                            return `<td><input type='text' id='jul_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        }

                                    },
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='aug_output_${_id}' value='${_forecast[10].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        } else {
                                            return `<td><input type='text' id='aug_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        }

                                    },
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='sep_output_${_id}' value='${_forecast[11].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        } else {
                                            return `<td><input type='text' id='sep_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        }

                                    },
                                },
                            ],
                        });

                    },
                    error: function () {
                        $('#add_name_table_1 tbody').empty();
                    }
                });
            }
        }

        function onSave() {
            $("#loading").css("display", "inline-block");
            var saveFlag = false;
            const rows = document.querySelectorAll("#forecast_table > tbody > tr");
            if (rows.length <= 0) {
                alert('No Rows Selected');
                return false;
            }
            $.each(rows, function (index, data) {
                console.log(data);
                //var rowId = data.dataset.rowid;
                var rowId = $(this).closest('tr').find('td').eq(0).children('input').val();
                var year = $('#period_search').find(":selected").val();
                var assignmentId = $('#row_id_' + rowId).val();

                var oct_point = $('#oct_' + rowId).val().replace(/,/g, '');
                var oct_output = $('#oct_output_' + rowId).val().replace(/,/g, '');

                var nov_point = $('#nov_' + rowId).val().replace(/,/g, '');
                var nov_output = $('#nov_output_' + rowId).val().replace(/,/g, '');


                var dec_point = $('#dec_' + rowId).val().replace(/,/g, '');
                var dec_output = $('#dec_output_' + rowId).val().replace(/,/g, '');

                var jan_point = $('#jan_' + rowId).val().replace(/,/g, '');
                var jan_output = $('#jan_output_' + rowId).val().replace(/,/g, '');

                var feb_point = $('#feb_' + rowId).val().replace(/,/g, '');
                var feb_output = $('#feb_output_' + rowId).val().replace(/,/g, '');

                var mar_point = $('#mar_' + rowId).val().replace(/,/g, '');
                var mar_output = $('#mar_output_' + rowId).val().replace(/,/g, '');

                var apr_point = $('#apr_' + rowId).val().replace(/,/g, '');
                var apr_output = $('#apr_output_' + rowId).val().replace(/,/g, '');

                var may_point = $('#may_' + rowId).val().replace(/,/g, '');
                var may_output = $('#may_output_' + rowId).val().replace(/,/g, '');

                var jun_point = $('#jun_' + rowId).val().replace(/,/g, '');
                var jun_output = $('#jun_output_' + rowId).val().replace(/,/g, '');

                var jul_point = $('#jul_' + rowId).val().replace(/,/g, '');
                var jul_output = $('#jul_output_' + rowId).val().replace(/,/g, '');

                var aug_point = $('#aug_' + rowId).val().replace(/,/g, '');
                var aug_output = $('#aug_output_' + rowId).val().replace(/,/g, '');

                var sep_point = $('#sep_' + rowId).val().replace(/,/g, '');
                var sep_output = $('#sep_output_' + rowId).val().replace(/,/g, '');

                var data = `10_${oct_point}_${oct_output},11_${nov_point}_${nov_output},12_${dec_point}_${dec_output},1_${jan_point}_${jan_output},2_${feb_point}_${feb_output},3_${mar_point}_${mar_output},4_${apr_point}_${apr_output},5_${may_point}_${may_output},6_${jun_point}_${jun_output},7_${jul_point}_${jul_output},8_${aug_point}_${aug_output},9_${sep_point}_${sep_output}`;


                $.ajax({
                    url: '/api/Forecasts',
                    type: 'GET',
                    async: false,
                    dataType: 'json',
                    data: {
                        data: data,
                        year: year,
                        assignmentId: assignmentId
                    },
                    success: function (data) {

                        saveFlag = data

                        //$('#modal_add_name_new').modal('toggle');
                        //$("#loading").css("display", "inline-block");

                    },

                    error: function (data) {
                        console.log(data);
                        $("#loading").css("display", "none");
                        saveFlag = false;
                        alert("Error please try again");
                        //$('#modal_add_name_new').modal('toggle');
                    }
                });
            });

            if (saveFlag) {
                $("#loading").css("display", "none");
                //$('#save_forecast').css('display', 'none');

                Command: toastr["success"]('Data Saved Successfully', "Success")

                toastr.options = {
                    "closeButton": false,
                    "debug": false,
                    "newestOnTop": false,
                    "progressBar": false,
                    "positionClass": "toast-top-right",
                    "preventDuplicates": false,
                    "onclick": null,
                    "showDuration": "3000",
                    "hideDuration": "1000",
                    "timeOut": "5000",
                    "extendedTimeOut": "1000",
                    "showEasing": "swing",
                    "hideEasing": "linear",
                    "showMethod": "fadeIn",
                    "hideMethod": "fadeOut"
                }
            }

            //$('#forecast_table > tbody').empty();
            //$('#forecast_table').DataTable().destroy();
            $('#forecast_table').empty();
            onCancel();

        }





        var expanded = false;
        $(document).on("click", function (event) {
            var $trigger = $(".forecast_multiselect");
            //alert("trigger: "+$trigger);
            if ($trigger !== event.target && !$trigger.has(event.target).length) {
                $(".commonselect").slideUp("fast");
                expanded = false;
            }
        });
        $(document).ready(function () {
            $('#forecast_name').click(function () {
                NameListSort("name_asc", "name_desc");
            });
            $('#forecast_section').click(function () {
                NameListSort("section_asc", "section_desc");
            });
            $('#forecast_department').click(function () {
                NameListSort("department_asc", "department_desc");
            });
            $('#forecast_incharge').click(function () {
                NameListSort("incharge_asc", "incharge_desc");
            });
            $('#forecast_role').click(function () {
                NameListSort("role_asc", "role_desc");
            });
            $('#forecast_explanation').click(function () {
                NameListSort("explanation_asc", "explanation_desc");
            });
            $('#forecast_company').click(function () {
                NameListSort("company_asc", "company_desc");
            });
            $('#forecast_grade').click(function () {
                NameListSort("grade_asc", "grade_desc");
            });
            $('#forecast_unitprice').click(function () {
                NameListSort("unit_asc", "unit_desc");
            });

            // multiple search by section
            $(document).on('click', '#sectionChks input[type="checkbox"]', function () {
                let isSectionAllChk = $("#chk_sec_all").is(':checked');
                var isDepartmentAllCheck = $("#chk_dept_all").is(':checked');
                var isInChargeAllCheck = $("#chk_incharge_all").is(':checked');
                var isRoleAllCheck = $("#chk_role_all").is(':checked');
                var isExplanationAllCheck = $("#chk_explanation_all").is(':checked');
                var isCompanytAllCheck = $("#chk_comopany_all").is(':checked');

                var clicked_checkbox = $(this).attr("id")

                if (clicked_checkbox.toLowerCase() == "chk_sec_all") {
                    $(".section_checkbox").prop("checked", isSectionAllChk);
                } else {
                    $("#chk_sec_all").prop("checked", false);
                }


                clicked_checkbox = "";

                var employeeName = "";
                var sectionCheck = [];
                var departmentCheck = [];
                var inchargeCheck = [];
                var roleCheck = [];
                var explanationCheck = [];
                var companyCheck = [];

                employeeName = $('#name_search').val();
                var sectionCheckedBoxes = $('#sectionChks input[type="checkbox"]:checked');
                var departmentCheckedBoxes = $('#departmentChks input[type="checkbox"]:checked');
                var inchargeCheckedBoxes = $('#inchargeChks input[type="checkbox"]:checked');
                var roleCheckedBoxes = $('#RoleChks input[type="checkbox"]:checked');
                var explanationCheckedBoxes = $('#ExplanationChks input[type="checkbox"]:checked');
                var companyCheckedBoxes = $('#CompanyChks input[type="checkbox"]:checked');

                $("#hidSectionId").val('');
                if (!isSectionAllChk) {
                    $.each(sectionCheckedBoxes, function (index, item) {
                        sectionCheck.push(item.value);
                    });
                }
                $("#hidSectionId").val(sectionCheck);

                $("#hidDepartmentId").val('');
                if (!isDepartmentAllCheck) {
                    $.each(departmentCheckedBoxes, function (index, item) {
                        departmentCheck.push(item.value);
                    });
                }
                $("#hidDepartmentId").val(departmentCheck);

                $("#hidInChargeId").val('');
                if (!isInChargeAllCheck) {
                    $.each(inchargeCheckedBoxes, function (index, item) {
                        inchargeCheck.push(item.value);
                    });
                }
                $("#hidInChargeId").val(inchargeCheck);

                $("#hidRoleId").val('');
                if (!isRoleAllCheck) {
                    $.each(roleCheckedBoxes, function (index, item) {
                        roleCheck.push(item.value);
                    });
                }
                $("#hidRoleId").val(roleCheck);

                $("#hidExplanationId").val('');
                if (!isExplanationAllCheck) {
                    $.each(explanationCheckedBoxes, function (index, item) {
                        explanationCheck.push(item.value);
                    });
                }
                $("#hidExplanationId").val(explanationCheck);

                $("#hidCompanyid").val('');
                if (!isCompanytAllCheck) {
                    $.each(companyCheckedBoxes, function (index, item) {
                        companyCheck.push(item.value);
                    });
                }
                $("#hidCompanyid").val(companyCheck);

                //var sectionSearchId = "";
                //if (!isSectionAllChk) {
                //    $.each(sectionCheckedBoxes, function(index, item) {
                //        if(sectionSearchId == ""){
                //            sectionSearchId = item.value;
                //        }
                //        else{
                //            sectionSearchId = sectionSearchId + ","+item.value;
                //        }
                //    });
                //}
                //$("#hidSectionId").val(sectionSearchId);
            });

            // multiple search by departments
            $(document).on('click', '#departmentChks input[type="checkbox"]', function () {
                let isSectionAllChk = $("#chk_sec_all").is(':checked');
                var isDepartmentAllCheck = $("#chk_dept_all").is(':checked');
                var isInChargeAllCheck = $("#chk_incharge_all").is(':checked');
                var isRoleAllCheck = $("#chk_role_all").is(':checked');
                var isExplanationAllCheck = $("#chk_explanation_all").is(':checked');
                var isCompanytAllCheck = $("#chk_comopany_all").is(':checked');

                var clicked_checkbox = $(this).attr("id")

                if (clicked_checkbox.toLowerCase() == "chk_dept_all") {
                    $(".department_checkbox").prop("checked", isDepartmentAllCheck);
                } else {
                    $("#chk_dept_all").prop("checked", false);
                }

                var employeeName = "";
                var sectionCheck = [];
                var departmentCheck = [];
                var inchargeCheck = [];
                var roleCheck = [];
                var explanationCheck = [];
                var companyCheck = [];



                employeeName = $('#name_search').val();
                var sectionCheckedBoxes = $('#sectionChks input[type="checkbox"]:checked');
                var departmentCheckedBoxes = $('#departmentChks input[type="checkbox"]:checked');
                var inchargeCheckedBoxes = $('#inchargeChks input[type="checkbox"]:checked');
                var roleCheckedBoxes = $('#RoleChks input[type="checkbox"]:checked');
                var explanationCheckedBoxes = $('#ExplanationChks input[type="checkbox"]:checked');
                var companyCheckedBoxes = $('#CompanyChks input[type="checkbox"]:checked');

                $("#hidSectionId").val('');
                if (!isSectionAllChk) {
                    $.each(sectionCheckedBoxes, function (index, item) {
                        sectionCheck.push(item.value);
                    });
                }
                $("#hidSectionId").val(sectionCheck);

                $("#hidDepartmentId").val('');
                if (!isDepartmentAllCheck) {
                    $.each(departmentCheckedBoxes, function (index, item) {
                        departmentCheck.push(item.value);
                    });
                }
                $("#hidDepartmentId").val(departmentCheck);

                $("#hidInChargeId").val('');
                if (!isInChargeAllCheck) {
                    $.each(inchargeCheckedBoxes, function (index, item) {
                        inchargeCheck.push(item.value);
                    });
                }
                $("#hidInChargeId").val(inchargeCheck);

                $("#hidRoleId").val('');
                if (!isRoleAllCheck) {
                    $.each(roleCheckedBoxes, function (index, item) {
                        roleCheck.push(item.value);
                    });
                }
                $("#hidRoleId").val(roleCheck);

                $("#hidExplanationId").val('');
                if (!isExplanationAllCheck) {
                    $.each(explanationCheckedBoxes, function (index, item) {
                        explanationCheck.push(item.value);
                    });
                }
                $("#hidExplanationId").val(explanationCheck);

                $("#hidCompanyid").val('');
                if (!isCompanytAllCheck) {
                    $.each(companyCheckedBoxes, function (index, item) {
                        companyCheck.push(item.value);
                    });
                }
                $("#hidCompanyid").val(companyCheck);

                //var departmentIds = "";
                //$("#hidDepartmentId").val('');
                //if (!isDepartmentAllCheck) {
                //    $.each(departmentCheckedBoxes, function(index, item) {
                //        //sectionCheck.push(item.value);
                //        if(departmentIds == ""){
                //            departmentIds = item.value;
                //        }
                //        else{
                //            departmentIds = departmentIds + ","+item.value;
                //        }
                //    });
                //}
                //$("#hidDepartmentId").val(departmentIds);
            });

            // multiple search by incharges
            $(document).on('click', '#inchargeChks input[type="checkbox"]', function () {
                let isSectionAllChk = $("#chk_sec_all").is(':checked');
                var isDepartmentAllCheck = $("#chk_dept_all").is(':checked');
                var isInChargeAllCheck = $("#chk_incharge_all").is(':checked');
                var isRoleAllCheck = $("#chk_role_all").is(':checked');
                var isExplanationAllCheck = $("#chk_explanation_all").is(':checked');
                var isCompanytAllCheck = $("#chk_comopany_all").is(':checked');

                var clicked_checkbox = $(this).attr("id")

                if (clicked_checkbox.toLowerCase() == "chk_incharge_all") {
                    $(".incharge_checkbox").prop("checked", isInChargeAllCheck);
                } else {
                    $("#chk_incharge_all").prop("checked", false);
                }

                var employeeName = "";
                var sectionCheck = [];
                var departmentCheck = [];
                var inchargeCheck = [];
                var roleCheck = [];
                var explanationCheck = [];
                var companyCheck = [];



                employeeName = $('#name_search').val();
                var sectionCheckedBoxes = $('#sectionChks input[type="checkbox"]:checked');
                var departmentCheckedBoxes = $('#departmentChks input[type="checkbox"]:checked');
                var inchargeCheckedBoxes = $('#inchargeChks input[type="checkbox"]:checked');
                var roleCheckedBoxes = $('#RoleChks input[type="checkbox"]:checked');
                var explanationCheckedBoxes = $('#ExplanationChks input[type="checkbox"]:checked');
                var companyCheckedBoxes = $('#CompanyChks input[type="checkbox"]:checked');

                $("#hidSectionId").val('');
                if (!isSectionAllChk) {
                    $.each(sectionCheckedBoxes, function (index, item) {
                        sectionCheck.push(item.value);
                    });
                }
                $("#hidSectionId").val(sectionCheck);

                $("#hidDepartmentId").val('');
                if (!isDepartmentAllCheck) {
                    $.each(departmentCheckedBoxes, function (index, item) {
                        departmentCheck.push(item.value);
                    });
                }
                $("#hidDepartmentId").val(departmentCheck);

                $("#hidInChargeId").val('');
                if (!isInChargeAllCheck) {
                    $.each(inchargeCheckedBoxes, function (index, item) {
                        inchargeCheck.push(item.value);
                    });
                }
                $("#hidInChargeId").val(inchargeCheck);

                $("#hidRoleId").val('');
                if (!isRoleAllCheck) {
                    $.each(roleCheckedBoxes, function (index, item) {
                        roleCheck.push(item.value);
                    });
                }
                $("#hidRoleId").val(roleCheck);

                $("#hidExplanationId").val('');
                if (!isExplanationAllCheck) {
                    $.each(explanationCheckedBoxes, function (index, item) {
                        explanationCheck.push(item.value);
                    });
                }
                $("#hidExplanationId").val(explanationCheck);

                $("#hidCompanyid").val('');
                if (!isCompanytAllCheck) {
                    $.each(companyCheckedBoxes, function (index, item) {
                        companyCheck.push(item.value);
                    });
                }
                $("#hidCompanyid").val(companyCheck);

                //var inchargeIds = "";
                //$("#hidInChargeId").val('');
                //if (!isInChargeAllCheck) {
                //    $.each(inchargeCheckedBoxes, function(index, item) {
                //        //sectionCheck.push(item.value);
                //        if(inchargeIds == ""){
                //            inchargeIds = item.value;
                //        }
                //        else{
                //            inchargeIds = inchargeIds + ","+item.value;
                //        }
                //    });
                //}
                //$("#hidInChargeId").val(inchargeIds);
            });

            // multiple search by roles
            $(document).on('click', '#RoleChks input[type="checkbox"]', function () {
                let isSectionAllChk = $("#chk_sec_all").is(':checked');
                var isDepartmentAllCheck = $("#chk_dept_all").is(':checked');
                var isInChargeAllCheck = $("#chk_incharge_all").is(':checked');
                var isRoleAllCheck = $("#chk_role_all").is(':checked');
                var isExplanationAllCheck = $("#chk_explanation_all").is(':checked');
                var isCompanytAllCheck = $("#chk_comopany_all").is(':checked');

                var clicked_checkbox = $(this).attr("id")

                if (clicked_checkbox.toLowerCase() == "chk_role_all") {
                    $(".role_checkbox").prop("checked", isRoleAllCheck);
                } else {
                    $("#chk_role_all").prop("checked", false);
                }


                var employeeName = "";
                var sectionCheck = [];
                var departmentCheck = [];
                var inchargeCheck = [];
                var roleCheck = [];
                var explanationCheck = [];
                var companyCheck = [];



                employeeName = $('#name_search').val();
                var sectionCheckedBoxes = $('#sectionChks input[type="checkbox"]:checked');
                var departmentCheckedBoxes = $('#departmentChks input[type="checkbox"]:checked');
                var inchargeCheckedBoxes = $('#inchargeChks input[type="checkbox"]:checked');
                var roleCheckedBoxes = $('#RoleChks input[type="checkbox"]:checked');
                var explanationCheckedBoxes = $('#ExplanationChks input[type="checkbox"]:checked');
                var companyCheckedBoxes = $('#CompanyChks input[type="checkbox"]:checked');

                $("#hidSectionId").val('');
                if (!isSectionAllChk) {
                    $.each(sectionCheckedBoxes, function (index, item) {
                        sectionCheck.push(item.value);
                    });
                }
                $("#hidSectionId").val(sectionCheck);

                $("#hidDepartmentId").val('');
                if (!isDepartmentAllCheck) {
                    $.each(departmentCheckedBoxes, function (index, item) {
                        departmentCheck.push(item.value);
                    });
                }
                $("#hidDepartmentId").val(departmentCheck);

                $("#hidInChargeId").val('');
                if (!isInChargeAllCheck) {
                    $.each(inchargeCheckedBoxes, function (index, item) {
                        inchargeCheck.push(item.value);
                    });
                }
                $("#hidInChargeId").val(inchargeCheck);

                $("#hidRoleId").val('');
                if (!isRoleAllCheck) {
                    $.each(roleCheckedBoxes, function (index, item) {
                        roleCheck.push(item.value);
                    });
                }
                $("#hidRoleId").val(roleCheck);

                $("#hidExplanationId").val('');
                if (!isExplanationAllCheck) {
                    $.each(explanationCheckedBoxes, function (index, item) {
                        explanationCheck.push(item.value);
                    });
                }
                $("#hidExplanationId").val(explanationCheck);

                $("#hidCompanyid").val('');
                if (!isCompanytAllCheck) {
                    $.each(companyCheckedBoxes, function (index, item) {
                        companyCheck.push(item.value);
                    });
                }
                $("#hidCompanyid").val(companyCheck);

                //var roleIds = "";
                //$("#hidRoleId").val('');
                //if (!isRoleAllCheck) {
                //    $.each(roleCheckedBoxes, function(index, item) {
                //        //sectionCheck.push(item.value);
                //        if(roleIds == ""){
                //            roleIds = item.value;
                //        }
                //        else{
                //            roleIds = roleIds + ","+item.value;
                //        }
                //    });
                //}
                //$("#hidRoleId").val(roleIds);

            });

            // multiple search by explanations
            $(document).on('click', '#ExplanationChks input[type="checkbox"]', function () {
                let isSectionAllChk = $("#chk_sec_all").is(':checked');
                var isDepartmentAllCheck = $("#chk_dept_all").is(':checked');
                var isInChargeAllCheck = $("#chk_incharge_all").is(':checked');
                var isRoleAllCheck = $("#chk_role_all").is(':checked');
                var isExplanationAllCheck = $("#chk_explanation_all").is(':checked');
                var isCompanytAllCheck = $("#chk_comopany_all").is(':checked');

                var clicked_checkbox = $(this).attr("id")

                if (clicked_checkbox.toLowerCase() == "chk_explanation_all") {
                    $(".explanation_checkbox").prop("checked", isExplanationAllCheck);
                } else {
                    $("#chk_explanation_all").prop("checked", false);
                }

                var employeeName = "";
                var sectionCheck = [];
                var departmentCheck = [];
                var inchargeCheck = [];
                var roleCheck = [];
                var explanationCheck = [];
                var companyCheck = [];



                employeeName = $('#name_search').val();
                var sectionCheckedBoxes = $('#sectionChks input[type="checkbox"]:checked');
                var departmentCheckedBoxes = $('#departmentChks input[type="checkbox"]:checked');
                var inchargeCheckedBoxes = $('#inchargeChks input[type="checkbox"]:checked');
                var roleCheckedBoxes = $('#RoleChks input[type="checkbox"]:checked');
                var explanationCheckedBoxes = $('#ExplanationChks input[type="checkbox"]:checked');
                var companyCheckedBoxes = $('#CompanyChks input[type="checkbox"]:checked');

                $("#hidSectionId").val('');
                if (!isSectionAllChk) {
                    $.each(sectionCheckedBoxes, function (index, item) {
                        sectionCheck.push(item.value);
                    });
                }
                $("#hidSectionId").val(sectionCheck);

                $("#hidDepartmentId").val('');
                if (!isDepartmentAllCheck) {
                    $.each(departmentCheckedBoxes, function (index, item) {
                        departmentCheck.push(item.value);
                    });
                }
                $("#hidDepartmentId").val(departmentCheck);

                $("#hidInChargeId").val('');
                if (!isInChargeAllCheck) {
                    $.each(inchargeCheckedBoxes, function (index, item) {
                        inchargeCheck.push(item.value);
                    });
                }
                $("#hidInChargeId").val(inchargeCheck);

                $("#hidRoleId").val('');
                if (!isRoleAllCheck) {
                    $.each(roleCheckedBoxes, function (index, item) {
                        roleCheck.push(item.value);
                    });
                }
                $("#hidRoleId").val(roleCheck);

                $("#hidExplanationId").val('');
                if (!isExplanationAllCheck) {
                    $.each(explanationCheckedBoxes, function (index, item) {
                        explanationCheck.push(item.value);
                    });
                }
                $("#hidExplanationId").val(explanationCheck);

                $("#hidCompanyid").val('');
                if (!isCompanytAllCheck) {
                    $.each(companyCheckedBoxes, function (index, item) {
                        companyCheck.push(item.value);
                    });
                }
                $("#hidCompanyid").val(companyCheck);

                //var explanationIds = "";
                //$("#hidExplanationId").val('');
                //if (!isExplanationAllCheck) {
                //    $.each(explanationCheckedBoxes, function(index, item) {
                //        //sectionCheck.push(item.value);
                //        if(explanationIds == ""){
                //            explanationIds = item.value;
                //        }
                //        else{
                //            explanationIds = explanationIds + ","+item.value;
                //        }
                //    });
                //}
                //$("#hidExplanationId").val(explanationIds);
            });

            // multiple search by companies
            $(document).on('click', '#CompanyChks input[type="checkbox"]', function () {
                let isSectionAllChk = $("#chk_sec_all").is(':checked');
                var isDepartmentAllCheck = $("#chk_dept_all").is(':checked');
                var isInChargeAllCheck = $("#chk_incharge_all").is(':checked');
                var isRoleAllCheck = $("#chk_role_all").is(':checked');
                var isExplanationAllCheck = $("#chk_explanation_all").is(':checked');
                var isCompanytAllCheck = $("#chk_comopany_all").is(':checked');

                var clicked_checkbox = $(this).attr("id")

                if (clicked_checkbox.toLowerCase() == "chk_comopany_all") {
                    $(".comopany_checkbox").prop("checked", isCompanytAllCheck);
                } else {
                    $("#chk_comopany_all").prop("checked", false);
                }

                var employeeName = "";
                var sectionCheck = [];
                var departmentCheck = [];
                var inchargeCheck = [];
                var roleCheck = [];
                var explanationCheck = [];
                var companyCheck = [];



                employeeName = $('#name_search').val();
                var sectionCheckedBoxes = $('#sectionChks input[type="checkbox"]:checked');
                var departmentCheckedBoxes = $('#departmentChks input[type="checkbox"]:checked');
                var inchargeCheckedBoxes = $('#inchargeChks input[type="checkbox"]:checked');
                var roleCheckedBoxes = $('#RoleChks input[type="checkbox"]:checked');
                var explanationCheckedBoxes = $('#ExplanationChks input[type="checkbox"]:checked');
                var companyCheckedBoxes = $('#CompanyChks input[type="checkbox"]:checked');

                $("#hidSectionId").val('');
                if (!isSectionAllChk) {
                    $.each(sectionCheckedBoxes, function (index, item) {
                        sectionCheck.push(item.value);
                    });
                }
                $("#hidSectionId").val(sectionCheck);

                $("#hidDepartmentId").val('');
                if (!isDepartmentAllCheck) {
                    $.each(departmentCheckedBoxes, function (index, item) {
                        departmentCheck.push(item.value);
                    });
                }
                $("#hidDepartmentId").val(departmentCheck);

                $("#hidInChargeId").val('');
                if (!isInChargeAllCheck) {
                    $.each(inchargeCheckedBoxes, function (index, item) {
                        inchargeCheck.push(item.value);
                    });
                }
                $("#hidInChargeId").val(inchargeCheck);

                $("#hidRoleId").val('');
                if (!isRoleAllCheck) {
                    $.each(roleCheckedBoxes, function (index, item) {
                        roleCheck.push(item.value);
                    });
                }
                $("#hidRoleId").val(roleCheck);

                $("#hidExplanationId").val('');
                if (!isExplanationAllCheck) {
                    $.each(explanationCheckedBoxes, function (index, item) {
                        explanationCheck.push(item.value);
                    });
                }
                $("#hidExplanationId").val(explanationCheck);

                $("#hidCompanyid").val('');
                if (!isCompanytAllCheck) {
                    $.each(companyCheckedBoxes, function (index, item) {
                        companyCheck.push(item.value);
                    });
                }
                $("#hidCompanyid").val(companyCheck);

                //var companyIds = "";
                //$("#hidCompanyid").val('');
                //if (!isCompanytAllCheck) {
                //    $.each(companyCheckedBoxes, function(index, item) {
                //        //sectionCheck.push(item.value);
                //        if(companyIds == ""){
                //            companyIds = item.value;
                //        }
                //        else{
                //            companyIds = companyIds + ","+item.value;
                //        }
                //    });
                //}
                //$("#hidCompanyid").val(companyIds);
            });



            // var expanded = false;
            // $(document).on("click", function (event) {
            //     var $trigger = $(".forecast_multiselect");
            //     //alert("trigger: "+$trigger);
            //     if ($trigger !== event.target && !$trigger.has(event.target).length) {
            //         $(".commonselect").slideUp("fast");
            //     }
            // });

            ForecastSearchDropdownInLoad();
            // $('.container').blur(function (e) {
            //     $('.commonselect').fadeOut(100);
            // });

            $('#forecast_table').on('change', '.input_month', function () {

                //var rowId = parseInt($(this).closest('tr').data('rowid'));
                var rowId = $(this).closest('tr').find('td').eq(0).children('input').val();
                console.log('row_d:' + rowId);
                //console.log($(this).closest('tr').find('td').eq(1).children('input').val());
                var month = parseInt($(this).data('month'));
                console.log('month ' + month);
                var unitPrice = parseFloat($('#up_' + rowId).data('unitprice').replace(/,/g, ''));
                console.log('unitprice ' + unitPrice)
                var pointValue = parseFloat($(this).val());
                console.log('point ' + pointValue)
                let result = 0;
                switch (month) {
                    case 1:
                        result = unitPrice * pointValue;
                        $('#jan_output_' + rowId).val(result.toLocaleString());
                        break;
                    case 2:
                        result = unitPrice * pointValue;
                        $('#feb_output_' + rowId).val(result.toLocaleString());
                        break;
                    case 3:
                        result = unitPrice * pointValue;
                        $('#mar_output_' + rowId).val(result.toLocaleString());
                        break;
                    case 4:
                        result = unitPrice * pointValue;
                        $('#apr_output_' + rowId).val(result.toLocaleString());
                        break;
                    case 5:
                        result = unitPrice * pointValue;
                        $('#may_output_' + rowId).val(result.toLocaleString());
                        break;
                    case 6:
                        result = unitPrice * pointValue;
                        $('#jun_output_' + rowId).val(result.toLocaleString());
                        break;
                    case 7:
                        result = unitPrice * pointValue;
                        $('#jul_output_' + rowId).val(result.toLocaleString());
                        break;
                    case 8:
                        result = unitPrice * pointValue;
                        $('#aug_output_' + rowId).val(result.toLocaleString());
                        break;
                    case 9:
                        result = unitPrice * pointValue;
                        $('#sep_output_' + rowId).val(result.toLocaleString());
                        break;
                    case 10:
                        result = unitPrice * pointValue;
                        $('#oct_output_' + rowId).val(result.toLocaleString());
                        break;
                    case 11:
                        result = unitPrice * pointValue;
                        $('#nov_output_' + rowId).val(result.toLocaleString());
                        break;
                    case 12:
                        result = unitPrice * pointValue;
                        $('#dec_output_' + rowId).val(result.toLocaleString());
                        break;

                }


            });


            $('#forecast_search_button').on('click', function () {
                $("#loading").css("display", "none");
                var sectionId = $('#section_search').find(":selected").val();
                var inchargeId = $('#incharge_search').find(":selected").val();
                var departmentId = $('#department_search').find(":selected").val();
                var roleId = $('#role_search').find(":selected").val();
                var companyId = $('#company_search').find(":selected").val();
                var explanationId = $('#explanation_search').find(":selected").val();
                var employeeName = $('#identity_search').val();

                var year = $('#period_search').find(":selected").val();

                if (year == '' || year == undefined) {

                    alert('select year');
                    return false;
                }

                $('#cancel_forecast').css('display', 'inline-block');
                $('#save_forecast').css('display', 'inline-block');

                //if (departmentId == undefined) {
                //    departmentId = '';
                //}
                let isSectionAllChk = $("#chk_sec_all").is(':checked');
                var isDepartmentAllCheck = $("#chk_dept_all").is(':checked');
                var isInChargeAllCheck = $("#chk_incharge_all").is(':checked');
                var isRoleAllCheck = $("#chk_role_all").is(':checked');
                var isExplanationAllCheck = $("#chk_explanation_all").is(':checked');
                var isCompanytAllCheck = $("#chk_comopany_all").is(':checked');

                //var employeeName = "";
                var sectionCheck = [];
                var departmentCheck = [];
                var inchargeCheck = [];
                var roleCheck = [];
                var explanationCheck = [];
                var companyCheck = [];

                var sectionCheckedBoxes = $('#sectionChks input[type="checkbox"]:checked');
                var departmentCheckedBoxes = $('#departmentChks input[type="checkbox"]:checked');
                var inchargeCheckedBoxes = $('#inchargeChks input[type="checkbox"]:checked');
                var roleCheckedBoxes = $('#RoleChks input[type="checkbox"]:checked');
                var explanationCheckedBoxes = $('#ExplanationChks input[type="checkbox"]:checked');
                var companyCheckedBoxes = $('#CompanyChks input[type="checkbox"]:checked');

                sectionId = "";
                if (!isSectionAllChk) {
                    $.each(sectionCheckedBoxes, function (index, item) {
                        //sectionCheck.push(item.value);
                        if (sectionId == "") {
                            sectionId = item.value;
                        } else {
                            sectionId = sectionId + "##" + item.value;
                        }
                    });
                }

                departmentId = "";
                if (!isDepartmentAllCheck) {
                    $.each(departmentCheckedBoxes, function (index, item) {
                        //departmentCheck.push(item.value);
                        if (departmentId == "") {
                            departmentId = item.value;
                        } else {
                            departmentId = departmentId + "##" + item.value;
                        }
                    });
                }

                inchargeId = "";
                if (!isInChargeAllCheck) {
                    $.each(inchargeCheckedBoxes, function (index, item) {
                        //inchargeCheck.push(item.value);
                        if (inchargeId == "") {
                            inchargeId = item.value;
                        } else {
                            inchargeId = inchargeId + "##" + item.value;
                        }
                    });
                }
                roleId = "";
                if (!isRoleAllCheck) {
                    $.each(roleCheckedBoxes, function (index, item) {
                        //roleCheck.push(item.value);
                        if (roleId == "") {
                            roleId = item.value;
                        } else {
                            roleId = roleId + "##" + item.value;
                        }
                    });
                }
                explanationId = "";
                if (!isExplanationAllCheck) {
                    $.each(explanationCheckedBoxes, function (index, item) {
                        //explanationCheck.push(item.value);
                        if (explanationId == "") {
                            explanationId = item.value;
                        } else {
                            explanationId = explanationId + "##" + item.value;
                        }
                    });
                }
                companyId = "";
                if (!isCompanytAllCheck) {
                    $.each(companyCheckedBoxes, function (index, item) {
                        //companyCheck.push(item.value);
                        if (companyId == "") {
                            companyId = item.value;
                        } else {
                            companyId = companyId + "##" + item.value;
                        }
                    });
                }

                var data_info = {
                    employeeName: employeeName,
                    sectionId: sectionId,
                    departmentId: departmentId,
                    inchargeId: inchargeId,
                    roleId: roleId,
                    explanationId: explanationId,
                    companyId: companyId,
                    status: '', year: ''
                };

                globalSearchObject = data_info;

                $.ajax({
                    //url: `/api/utilities/SearchForecastEmployee`,
                    //type: 'GET',
                    //dataType: 'json',
                    //data: data_info,
                    url: `/api/utilities/SearchForecastEmployee`,
                    contentType: 'application/json',
                    type: 'GET',
                    dataType: 'json',
                    data: data_info,
                    success: function (data) {
                        $('#forecast_table>thead').empty();
                        $('#forecast_table>tbody').empty();

                        $('#forecast_table>thead').append(`

                                                <tr>
                                                    <th id="forecast_name">Name </th>
                                                    <th id="forecast_section">Section </th>
                                                    <th id="forecast_department">Department </th>
                                                    <th id="forecast_incharge">In-Charge </th>
                                                    <th id="forecast_role">Role </th>
                                                    <th id="forecast_explanation">Explanation </th>
                                                    <th id="forecast_company">Company Name </i></th>
                                                    <th id="forecast_grade">Grade </th>
                                                    <th id="forecast_unitprice"><span>Unit Price</span> </th>
                                                    <th>10月</th>
                                                    <th>11月</th>
                                                    <th>12月</th>
                                                    <th>1月</th>
                                                    <th>2月</th>
                                                    <th>3月</th>
                                                    <th>4月</th>
                                                    <th>5月</th>
                                                    <th>6月</th>
                                                    <th>7月</th>
                                                    <th>8月</th>
                                                    <th>9月</th>
                                                    <th>Oct</th>
                                                    <th>Nov</th>
                                                    <th>Dec</th>
                                                    <th>Jan</th>
                                                    <th>Feb</th>
                                                    <th>Mar</th>
                                                    <th>Apr</th>
                                                    <th>May</th>
                                                    <th>Jun</th>
                                                    <th>Jul</th>
                                                    <th>Aug</th>
                                                    <th>Sep</th>
                                                </tr>
                                            `);
                        //Forecast_DatatableLoad(data);
                        var _id = 0;
                        var _companyName = '';
                        var _oct = 0;
                        var _octTotal = 0;

                        console.log(data);
                        $('#forecast_table').DataTable({
                            destroy: true,
                            data: data,
                            searching: false,
                            bLengthChange: false,
                            autoWidth: false,
                            pageLength: 100,
                            columns: [
                                //{
                                //    data: 'Id',
                                //    render: function (id) {
                                //        _id = id;
                                //        return null;
                                //    },
                                //    //ordering: false

                                //},
                                {
                                    data: 'EmployeeNameWithCodeRemarks',
                                    render: function (employeeNameWithCodeRemarks) {
                                        var splittedString = employeeNameWithCodeRemarks.split('$');
                                        _id = parseInt(splittedString[3]); // id
                                        if (splittedString[2] == 'true') {
                                            return `<span title='initial' data-name='${splittedString[0]}' style='color:red;'> ${splittedString[1]}</span> <input type='hidden' id='row_id_${_id}' value='${_id}'/>`;
                                        } else {
                                            return `<span title='initial' data-name='${splittedString[0]}'> ${splittedString[1]}</span> <input type='hidden' id='row_id_${_id}' value='${_id}'/>`;
                                        }

                                    }
                                },
                                {
                                    data: 'SectionName',
                                    render: function (sectionName) {
                                        return `<td title='initial'>${sectionName}</td>`;
                                    }
                                },
                                {
                                    data: 'DepartmentName',
                                    render: function (departmentName) {
                                        return `<td title='initial'>${departmentName}</td>`;
                                    }
                                },
                                {
                                    data: 'InchargeName',
                                    render: function (inchargeName) {
                                        return `<td title='initial'>${inchargeName}</td>`;
                                    }
                                },
                                {
                                    data: 'RoleName',
                                    render: function (roleName) {
                                        return `<td title='initial'>${roleName}</td>`;
                                    }
                                },
                                {
                                    data: 'ExplanationName',
                                    render: function (explanationName) {
                                        return `<span title='initial' class='forecast_explanation'>${explanationName}</span>`;
                                    }
                                },
                                {
                                    data: 'CompanyName',
                                    render: function (companyName) {
                                        _companyName = companyName;
                                        return `<td title='initial'>${companyName}</td>`;
                                    }
                                },
                                {
                                    data: 'GradePoint',
                                    render: function (gradePoint) {

                                        if (_companyName.toLowerCase() == 'mw') {
                                            return `<td title='initial'>${gradePoint}</td>`;
                                        }
                                        else {
                                            return `<td title='initial'></td>`;
                                        }

                                    }
                                },
                                {
                                    data: 'UnitPrice',
                                    render: function (unitPrice) {
                                        return `<span id='up_${_id}' data-unitprice=${unitPrice}> ${unitPrice}</span>`;
                                    }
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='oct_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)"  data-month='10' value='${_forecast[0].Points.toFixed(1)}' class='input_month'/></td>`;
                                        } else {
                                            return `<td><input type='text' id='oct_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)"  data-month='10' value='0.0' class='input_month'/></td>`;
                                        }

                                    },
                                    orderable: false
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='nov_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='11' value='${_forecast[1].Points.toFixed(1)}' class='input_month'/></td>`;
                                        } else {
                                            return `<td><input type='text' id='nov_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='11' value='0.0' class='input_month'/></td>`;
                                        }

                                    },
                                    orderable: false
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='dec_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='12' value='${_forecast[2].Points.toFixed(1)}' class='input_month'/></td>`;
                                        } else {
                                            return `<td><input type='text' id='dec_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='12' value='0.0' class='input_month'/></td>`;
                                        }

                                    },
                                    orderable: false
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='jan_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='1' value='${_forecast[3].Points.toFixed(1)}' class='input_month'/></td>`;
                                        } else {
                                            return `<td><input type='text' id='jan_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='1' value='0.0' class='input_month'/></td>`;
                                        }

                                    },
                                    orderable: false
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='feb_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='2' value='${_forecast[4].Points.toFixed(1)}' class='input_month'/></td>`;
                                        } else {
                                            return `<td><input type='text' id='feb_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='2' value='0.0' class='input_month'/></td>`;
                                        }

                                    },
                                    orderable: false
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='mar_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='3' value='${_forecast[5].Points.toFixed(1)}' class='input_month'/></td>`;
                                        } else {
                                            return `<td><input type='text' id='mar_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='3' value='0.0' class='input_month'/></td>`;
                                        }

                                    },
                                    orderable: false
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='apr_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='4' value='${_forecast[6].Points.toFixed(1)}' class='input_month'/></td>`;
                                        } else {
                                            return `<td><input type='text' id='apr_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='4' value='0.0' class='input_month'/></td>`;
                                        }

                                    },
                                    orderable: false
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='may_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='5' value='${_forecast[7].Points.toFixed(1)}' class='input_month'/></td>`;
                                        } else {
                                            return `<td><input type='text' id='may_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='5' value='0.0' class='input_month'/></td>`;
                                        }

                                    },
                                    orderable: false
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='jun_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='6' value='${_forecast[8].Points.toFixed(1)}' class='input_month'/></td>`;
                                        } else {
                                            return `<td><input type='text' id='jun_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='6' value='0.0' class='input_month'/></td>`;
                                        }

                                    },
                                    orderable: false
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='jul_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='7' value='${_forecast[9].Points.toFixed(1)}' class='input_month'/></td>`;
                                        } else {
                                            return `<td><input type='text' id='jul_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='7' value='0.0' class='input_month'/></td>`;
                                        }

                                    },
                                    orderable: false
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='aug_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='8' value='${_forecast[10].Points.toFixed(1)}' class='input_month'/></td>`;
                                        } else {
                                            return `<td><input type='text' id='aug_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='8' value='0.0' class='input_month'/></td>`;
                                        }

                                    },
                                    orderable: false
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='sep_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='9' value='${_forecast[11].Points.toFixed(1)}' class='input_month'/></td>`;
                                        } else {
                                            return `<td><input type='text' id='sep_${_id}' onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='9' value='0.0' class='input_month'/></td>`;
                                        }

                                    },
                                    orderable: false
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='oct_output_${_id}' value='${_forecast[0].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        } else {
                                            return `<td><input type='text' id='oct_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        }

                                    },
                                    orderable: false
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='nov_output_${_id}' value='${_forecast[1].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        } else {
                                            return `<td><input type='text' id='nov_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        }

                                    },
                                    orderable: false
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='dec_output_${_id}' value='${_forecast[2].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        } else {
                                            return `<td><input type='text' id='dec_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        }

                                    },
                                    orderable: false
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='jan_output_${_id}' value='${_forecast[3].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        } else {
                                            return `<td><input type='text' id='jan_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        }

                                    },
                                    orderable: false
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='feb_output_${_id}' value='${_forecast[4].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        } else {
                                            return `<td><input type='text' id='feb_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        }

                                    },
                                    orderable: false
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='mar_output_${_id}' value='${_forecast[5].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        } else {
                                            return `<td><input type='text' id='mar_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        }

                                    },
                                    orderable: false
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='apr_output_${_id}' value='${_forecast[6].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        } else {
                                            return `<td><input type='text' id='apr_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        }

                                    },
                                    orderable: false
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='may_output_${_id}' value='${_forecast[7].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        } else {
                                            return `<td><input type='text' id='may_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        }

                                    },
                                    orderable: false
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='jun_output_${_id}' value='${_forecast[8].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        } else {
                                            return `<td><input type='text' id='jun_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        }

                                    },
                                    orderable: false
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='jul_output_${_id}' value='${_forecast[9].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        } else {
                                            return `<td><input type='text' id='jul_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        }

                                    },
                                    orderable: false
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='aug_output_${_id}' value='${_forecast[10].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        } else {
                                            return `<td><input type='text' id='aug_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        }

                                    },
                                    orderable: false
                                },
                                {
                                    data: 'forecasts',
                                    render: function (_forecast) {

                                        if (_forecast.length > 0) {
                                            return `<td><input type='text' id='sep_output_${_id}' value='${_forecast[11].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        } else {
                                            return `<td><input type='text' id='sep_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`;
                                        }

                                    },
                                    orderable: false
                                },
                            ],
                        });

                    },
                    error: function () {
                        $('#add_name_table_1 tbody').empty();
                    }
                });


            });


            // // for search
            // $.getJSON('/api/Roles/')
            //     .done(function (data) {
            //         $('#role_search').empty();
            //         $('#role_search').append(`<option value=''>Select Role</option>`);
            //         $.each(data, function (key, item) {
            //             $('#role_search').append(`<option value='${item.Id}'>${item.RoleName}</option>`);
            //         });
            //     });

            // // for search
            // $.getJSON('/api/Explanations/')
            //     .done(function (data) {
            //         $('#explanation_search').empty();
            //         $('#explanation_search').append(`<option value=''>Select Explanation</option>`);
            //         $.each(data, function (key, item) {
            //             $('#explanation_search').append(`<option value='${item.Id}'>${item.ExplanationName}</option>`);
            //         });
            //     });

            // // for search
            // $.getJSON('/api/Companies/')
            //     .done(function (data) {
            //         $('#company_search').empty();
            //         $('#company_search').append(`<option value=''>Select Company</option>`);
            //         $.each(data, function (key, item) {
            //             $('#company_search').append(`<option value='${item.Id}'>${item.CompanyName}</option>`);
            //         });
            //     });


            // // for search
            // $.getJSON('/api/incharges/')
            //     .done(function (data) {
            //         $('#incharge_search').empty();
            //         $('#incharge_search').append(`<option value=''>Select In-Charge</option>`);
            //         $.each(data, function (key, item) {
            //             $('#incharge_search').append(`<option value='${item.Id}'>${item.InChargeName}</option>`);
            //         });
            //     });

            // // for search
            // $.getJSON('/api/sections/')
            //     .done(function (data) {
            //         $('#section_search').empty();
            //         $('#section_search').append(`<option value=''>Select Section</option>`);
            //         $.each(data, function (key, item) {
            //             $('#section_search').append(`<option value='${item.Id}'>${item.SectionName}</option>`);
            //         });
            //     });


            $(document).on('change', '#section_search', function () {

                var sectionId = $(this).val();
                console.log(sectionId);

                $.getJSON(`/api/utilities/DepartmentsBySection/${sectionId}`)
                    .done(function (data) {
                        $('#department_search').empty();
                        $('#department_search').append(`<option value=''>Select Department</option>`);
                        $.each(data, function (key, item) {
                            $('#department_search').append(`<option value='${item.Id}'>${item.DepartmentName}</option>`);
                        });
                    });
            });


        });
    </script>

}


